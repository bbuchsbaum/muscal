% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/all_generic.R, R/covstatis.R
\name{covstatis}
\alias{covstatis}
\alias{covstatis.list}
\title{STATIS for Covariance Matrices (generic)}
\usage{
covstatis(data, ncomp = 2, normalize = TRUE, dcenter = TRUE, ...)

\method{covstatis}{list}(
  data,
  ncomp = 2,
  norm_method = c("frobenius", "mfa", "none"),
  dcenter = TRUE,
  labels = NULL
)
}
\arguments{
\item{data}{The dataset on which the bootstrap resampling should be performed.}

\item{ncomp}{Integer; number of components to compute.}

\item{normalize}{Logical; if `TRUE` (default) each covariance matrix is scaled
to have unit Frobenius norm before analysis.}

\item{dcenter}{Logical; if TRUE (default), each matrix is double-centered before
analysis. This removes constant modes before cross-table comparison
(standard in STATIS tradition).}

\item{...}{Additional arguments passed to the method.}

\item{norm_method}{The normalization method to apply to each matrix. One of
\code{"frobenius"} (default), \code{"mfa"}, or \code{"none"}. Frobenius norm
scales each matrix to have a total sum-of-squares of 1. MFA
(multiple factor analysis) scales each matrix so its first
eigenvalue is 1. \code{"none"} applies no normalization.}

\item{labels}{Optional character vector of labels for the rows/columns of the
covariance matrices. If NULL, tries to use row names from the
first matrix, or generates sequential labels.}
}
\value{
An object inheriting from class `covstatis`.
}
\description{
A generic function implementing the STATIS approach for a collection of
covariance matrices.  Method implementations should return an object of class
`\code{covstatis}`.
}
\details{
The \code{covstatis.list} method implements STATIS analysis for a list of covariance matrices.

The method operates as follows:
\enumerate{
\item Optionally double-centers each matrix (Gower transformation)
\item Optionally normalizes each matrix to unit Frobenius norm
\item Computes an RV matrix of inner products between matrices
\item Determines optimal weights (\code{alpha}) via first eigenvector of the RV matrix. These weights are accessible in the output and can be useful for outlier diagnostics.
\item Creates a compromise matrix as weighted sum of normalized matrices
\item Performs eigendecomposition on the compromise matrix
}

The \code{partial_scores} in the returned object are a list of matrices (one for each subject), with each matrix containing the ROI-level factor scores (ROI x D).
}
\examples{
# Create a list of correlation matrices
Xs <- lapply(1:5, function(i) matrix(rnorm(10*10), 10, 10))
Xs <- lapply(Xs, cor)

# Apply COVSTATIS
res <- covstatis(Xs, ncomp=3)

# Project a new correlation matrix
new_mat <- cor(matrix(rnorm(10*10), 10, 10))
proj <- project_cov(res, new_mat)

}
\seealso{
[covstatis.list] for the reference implementation.
}
