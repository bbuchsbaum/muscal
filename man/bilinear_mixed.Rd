% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bilinear_mixed.R
\name{bilinear_mixed}
\alias{bilinear_mixed}
\alias{bilinear_mixed.default}
\alias{bilinear_mixed.list}
\title{Bilinear Repeated-Measures Mixed Model}
\usage{
bilinear_mixed(
  data,
  subject,
  z = NULL,
  y = NULL,
  row_design = NULL,
  seed_design = NULL,
  mode = c("seed_axis", "seed_repeat", "both"),
  connectivity_type = c("auto", "cross", "symmetric"),
  symmetric = FALSE,
  sym_tol = 1e-08,
  complexity = c("manual", "fast", "balanced", "adaptive"),
  r_seed = 2,
  r_roi = 8,
  k_subject = 2,
  include_seed_interactions = TRUE,
  repeat_id = NULL,
  laplacian_repeat = NULL,
  laplacian_seed = NULL,
  laplacian_roi = NULL,
  laplacian_design = NULL,
  lambda_w = 0.01,
  lambda_t = 0.01,
  lambda_b = 0.001,
  lambda_a = 0.001,
  lambda_y = 0,
  lambda_repeat = 0,
  lambda_seed = 0,
  lambda_roi = 0,
  lambda_design_smooth = 0,
  max_iter = 50,
  tol = 1e-06,
  verbose = FALSE,
  ...
)

\method{bilinear_mixed}{default}(data, ...)

\method{bilinear_mixed}{list}(
  data,
  subject,
  z = NULL,
  y = NULL,
  row_design = NULL,
  seed_design = NULL,
  mode = c("seed_axis", "seed_repeat", "both"),
  connectivity_type = c("auto", "cross", "symmetric"),
  symmetric = FALSE,
  sym_tol = 1e-08,
  complexity = c("manual", "fast", "balanced", "adaptive"),
  r_seed = 2,
  r_roi = 8,
  k_subject = 2,
  include_seed_interactions = TRUE,
  repeat_id = NULL,
  laplacian_repeat = NULL,
  laplacian_seed = NULL,
  laplacian_roi = NULL,
  laplacian_design = NULL,
  lambda_w = 0.01,
  lambda_t = 0.01,
  lambda_b = 0.001,
  lambda_a = 0.001,
  lambda_y = 0,
  lambda_repeat = 0,
  lambda_seed = 0,
  lambda_roi = 0,
  lambda_design_smooth = 0,
  max_iter = 50,
  tol = 1e-06,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{data}{A list of numeric matrices. Each element is one observed
connectivity matrix (typically row-entity \eqn{\times} ROI, or symmetric
ROI \eqn{\times} ROI).}

\item{subject}{Subject identifier for each matrix in \code{data}.}

\item{z}{Optional repeat-level design matrix/data frame/vector (same number of
rows as \code{length(data)}).}

\item{y}{Optional subject-level traits. Can be a named numeric vector, a
matrix/data frame with one row per subject, or a vector ordered by subject
level.}

\item{row_design}{Optional row-entity design (vector/matrix with one row per
matrix row). Used by \code{mode = "seed_repeat"}.}

\item{seed_design}{Deprecated alias of \code{row_design}, retained for
backward compatibility.}

\item{mode}{One of \code{"seed_axis"}, \code{"seed_repeat"}, or \code{"both"}.}

\item{connectivity_type}{One of \code{"auto"}, \code{"cross"}, or
\code{"symmetric"}.}

\item{symmetric}{Deprecated logical alias for \code{connectivity_type =
"symmetric"}.}

\item{sym_tol}{Numeric tolerance for automatic symmetry detection in
\code{connectivity_type = "auto"}.}

\item{complexity}{One of \code{"manual"}, \code{"fast"},
\code{"balanced"}, or \code{"adaptive"}. If not \code{"manual"},
data-adaptive defaults are inferred for unspecified tuning parameters.}

\item{r_seed}{Rank for seed mode basis (row basis).}

\item{r_roi}{Rank for ROI mode basis (column basis).}

\item{k_subject}{Subject latent dimensionality.}

\item{include_seed_interactions}{Logical; if \code{TRUE}, includes
\eqn{z \otimes row\_design}{z x row_design} interactions in the seed-repeat head.}

\item{repeat_id}{Optional repeat/condition index per matrix. Required when
using \code{laplacian_repeat}.}

\item{laplacian_repeat}{Optional repeat Laplacian matrix.}

\item{laplacian_seed}{Optional seed-axis Laplacian.}

\item{laplacian_roi}{Optional ROI-axis Laplacian.}

\item{laplacian_design}{Optional design Laplacian on columns of \code{z}.}

\item{lambda_w}{Ridge penalty for \code{W}.}

\item{lambda_t}{Ridge penalty for subject scores \code{t}.}

\item{lambda_b}{Ridge penalty for design effects.}

\item{lambda_a}{Ridge penalty for supervision map \code{A}.}

\item{lambda_y}{Weight for supervised trait term.}

\item{lambda_repeat}{Smoothing strength for repeat smoothing.}

\item{lambda_seed}{Basis smoothing strength for seed basis.}

\item{lambda_roi}{Basis smoothing strength for ROI basis.}

\item{lambda_design_smooth}{Laplacian smoothing for design effects.}

\item{max_iter}{Maximum ALS iterations for the core mixed model.}

\item{tol}{Relative convergence tolerance for the core mixed model.}

\item{verbose}{Logical; if \code{TRUE}, prints iteration diagnostics.}

\item{...}{Reserved for future extensions.}
}
\value{
A list of class \code{"bilinear_mixed"} containing fitted
  head(s), bases, core-model parameters, and backprojected effect maps.
}
\description{
Fits a matrix-aware latent model for repeated connectivity matrices with
optional subject-level supervision. The method supports two complementary
representations:
\itemize{
  \item \code{"seed_axis"}: treat row entities as the row axis of each matrix (\eqn{s \times p}).
  \item \code{"seed_repeat"}: treat row profiles as repeated observations nested
  within subject/repeat.
  \item \code{"both"}: fit both heads with a shared ROI basis.
}
}
