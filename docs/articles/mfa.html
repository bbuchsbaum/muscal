<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiple Factor Analysis • muscal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multiple Factor Analysis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">muscal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/linked_mfa.html">Linked Multiple Factor Analysis</a>
    </li>
    <li>
      <a href="../articles/mfa.html">Multiple Factor Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multiple Factor Analysis</h1>
            
      

      <div class="hidden name"><code>mfa.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="why-mfa">Why MFA?<a class="anchor" aria-label="anchor" href="#why-mfa"></a>
</h2>
<p>Multiple Factor Analysis (MFA) solves a common problem: you have
measured the same observations using different instruments, different
feature sets, or at different time points—and you want a single,
integrated view. Standard PCA on the concatenated data fails here
because blocks with more variables or higher variance dominate the
solution. MFA corrects this by normalizing each block before
integration, ensuring that every data source contributes fairly to the
shared representation.</p>
<p>MFA belongs to the “French school” of multivariate analysis,
developed by Escofier and Pagès in the 1980s. It remains one of the most
principled approaches for multi-table data integration.</p>
</div>
<div class="section level2">
<h2 id="the-core-idea">The Core Idea<a class="anchor" aria-label="anchor" href="#the-core-idea"></a>
</h2>
<p>MFA proceeds in two stages:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Normalize each block</strong> so that no single block
dominates. The default approach divides each block by its first singular
value—this makes the maximum inertia of each block equal to 1.</p></li>
<li><p><strong>Apply PCA to the concatenated, normalized blocks</strong>
to extract global components that summarize the shared structure across
all data sources.</p></li>
</ol>
<p>The result is a compromise factor space where observations are
positioned according to their combined profile across all blocks.</p>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">muscal</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bbuchsbaum.github.io/multivarious/" class="external-link">multivarious</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate three blocks of data on the same 50 observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">block1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">20</span><span class="op">)</span>, <span class="va">n</span>, <span class="fl">20</span><span class="op">)</span>  <span class="co"># 20 variables</span></span>
<span><span class="va">block2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">15</span><span class="op">)</span>, <span class="va">n</span>, <span class="fl">15</span><span class="op">)</span>  <span class="co"># 15 variables</span></span>
<span><span class="va">block3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">25</span><span class="op">)</span>, <span class="va">n</span>, <span class="fl">25</span><span class="op">)</span>  <span class="co"># 25 variables</span></span>
<span></span>
<span><span class="co"># Fit MFA with 3 components</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mfa.html">mfa</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">block1</span>, <span class="va">block2</span>, <span class="va">block3</span><span class="op">)</span>, ncomp <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract global scores</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bbuchsbaum.github.io/multivarious/reference/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>  <span class="co"># 50 x 3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="normalization-schemes">Normalization Schemes<a class="anchor" aria-label="anchor" href="#normalization-schemes"></a>
</h2>
<p>MFA supports several block-weighting schemes via the
<code>normalization</code> argument: - <strong>“MFA”</strong> (default):
Weight by inverse squared first singular value. This is the classical
MFA normalization.</p>
<ul>
<li><p><strong>“RV”</strong>: Weight blocks by their contribution to the
RV coefficient matrix. Blocks that are more similar to the overall
structure receive higher weight.</p></li>
<li><p><strong>“Frob”</strong>: Weight by Frobenius norm.</p></li>
<li><p><strong>“None”</strong>: No normalization—equivalent to ordinary
PCA on concatenated data.</p></li>
<li><p><strong>“custom”</strong>: Supply your own weight matrices via
<code>A</code> (column weights) and <code>M</code> (row
weights).</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># RV-based normalization</span></span>
<span><span class="va">fit_rv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mfa.html">mfa</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">block1</span>, <span class="va">block2</span>, <span class="va">block3</span><span class="op">)</span>, ncomp <span class="op">=</span> <span class="fl">3</span>, normalization <span class="op">=</span> <span class="st">"RV"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Custom weights</span></span>
<span><span class="va">ncols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">15</span>, <span class="fl">25</span><span class="op">)</span></span>
<span><span class="va">custom_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">ncols</span>, <span class="va">ncols</span><span class="op">)</span>  <span class="co"># inverse-column-count weighting</span></span>
<span><span class="va">fit_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mfa.html">mfa</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">block1</span>, <span class="va">block2</span>, <span class="va">block3</span><span class="op">)</span>,</span>
<span>                  ncomp <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                  normalization <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>                  A <span class="op">=</span> <span class="va">custom_weights</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-the-results">Working with the Results<a class="anchor" aria-label="anchor" href="#working-with-the-results"></a>
</h2>
<p>MFA returns a <code>multiblock_biprojector</code> object that
integrates with the <code>multivarious</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Global scores (observations in the compromise space)</span></span>
<span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bbuchsbaum.github.io/multivarious/reference/scores.html" class="external-link">scores</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loadings in the concatenated variable space (sum(p_k) x ncomp)</span></span>
<span><span class="va">V</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">v</span></span>
<span></span>
<span><span class="co"># Block-specific loadings are slices of V using block_indices</span></span>
<span><span class="va">V_block1</span> <span class="op">&lt;-</span> <span class="va">V</span><span class="op">[</span><span class="va">fit</span><span class="op">$</span><span class="va">block_indices</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Project a single block onto the fitted model</span></span>
<span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bbuchsbaum.github.io/multivarious/reference/project_block.html" class="external-link">project_block</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">block1</span>, block <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Partial factor scores: how each block "sees" the observations</span></span>
<span><span class="co"># (useful for assessing block agreement)</span></span>
<span><span class="va">partial_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://bbuchsbaum.github.io/multivarious/reference/project_block.html" class="external-link">project_block</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">block2</span>, block <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interpreting-block-contributions">Interpreting Block Contributions<a class="anchor" aria-label="anchor" href="#interpreting-block-contributions"></a>
</h2>
<p>The <code>alpha</code> weights stored in the fitted object indicate
each block’s contribution:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">alpha</span></span></code></pre></div>
<p>Blocks with smaller first singular values receive larger weights—this
is how MFA equalizes their influence.</p>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>The <code>muscal</code> package provides several plotting functions
for MFA results. If <code>ggplot2</code> is installed, most functions
return ggplot objects; otherwise they fall back to base R graphics.</p>
<div class="section level3">
<h3 id="score-plot">Score Plot<a class="anchor" aria-label="anchor" href="#score-plot"></a>
</h3>
<p>The primary visualization shows observations in the compromise
space:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Base R</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ggplot2 (if installed)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With custom coloring</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit</span>, color <span class="op">=</span> <span class="va">groups</span>, labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="variance-explained">Variance Explained<a class="anchor" aria-label="anchor" href="#variance-explained"></a>
</h3>
<p>Assess how many components to retain:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bar chart of individual component variance</span></span>
<span><span class="fu"><a href="../reference/plot_variance.html">plot_variance</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Scree plot with cumulative line</span></span>
<span><span class="fu"><a href="../reference/plot_variance.html">plot_variance</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="block-weights">Block Weights<a class="anchor" aria-label="anchor" href="#block-weights"></a>
</h3>
<p>Understand the normalization effect:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_block_weights.html">plot_block_weights</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p>Blocks with smaller first singular values receive larger weights,
equalizing their contribution.</p>
</div>
<div class="section level3">
<h3 id="partial-factor-scores">Partial Factor Scores<a class="anchor" aria-label="anchor" href="#partial-factor-scores"></a>
</h3>
<p>Compare how each block “sees” the observations:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_partial_scores.html">plot_partial_scores</a></span><span class="op">(</span><span class="va">fit</span>, connect <span class="op">=</span> <span class="cn">TRUE</span>, show_consensus <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Lines connect partial scores to the consensus position. Large
divergence indicates block disagreement for that observation.</p>
</div>
<div class="section level3">
<h3 id="variable-loadings">Variable Loadings<a class="anchor" aria-label="anchor" href="#variable-loadings"></a>
</h3>
<p>Visualize variable contributions:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Correlation circle colored by block</span></span>
<span><span class="fu"><a href="../reference/plot_loadings.html">plot_loadings</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"circle"</span>, color_by <span class="op">=</span> <span class="st">"block"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Top loadings for a specific component</span></span>
<span><span class="fu"><a href="../reference/plot_loadings.html">plot_loadings</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"bar"</span>, component <span class="op">=</span> <span class="fl">1</span>, top_n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="when-to-use-mfa">When to Use MFA<a class="anchor" aria-label="anchor" href="#when-to-use-mfa"></a>
</h2>
<p>MFA is appropriate when:</p>
<ul>
<li>You have multiple measurement modalities on the same subjects (e.g.,
gene expression + metabolomics + clinical variables).</li>
<li>You want to identify patterns that are consistent across data
sources.</li>
<li>You need block contributions to be balanced regardless of the number
of variables per block.</li>
</ul>
<p>MFA is <em>not</em> appropriate when:</p>
<ul>
<li>Blocks have different observations (use Linked MFA instead).</li>
<li>You want blocks with more variables to naturally dominate (use
standard PCA).</li>
<li>Your goal is prediction rather than exploratory structure
discovery.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Escofier, B., &amp; Pagès, J. (1994). Multiple factor analysis
(AFMULT package). <em>Computational Statistics &amp; Data Analysis</em>,
18(1), 121-140.</p>
<p>Abdi, H., Williams, L. J., &amp; Valentin, D. (2013). Multiple factor
analysis: Principal component analysis for multitable and multiblock
data sets. <em>Wiley Interdisciplinary Reviews: Computational
Statistics</em>, 5(2), 149-179.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
